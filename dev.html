<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>LCP - QuÃ¡n Net Chat Lan</title>
  <link rel="icon" href="https://raw.githubusercontent.com/lapgia57-netizen/LCP/main/favicon.ico" type="image/x-icon">
  <style>
    body { margin:0; font-family: system-ui; background:#0d1117; color:#c9d1d9; }
    .header { background:#010409; padding:20px; text-align:center; border-bottom:3px solid #f85149; }
    h1 { margin:0; color:#f85149; }
    .container { display:flex; height:calc(100vh - 100px); }
    .sidebar { width:35%; background:#161b22; border-right:1px solid #30363d; overflow:auto; }
    .content { width:65%; padding:20px; overflow:auto; }
    .tree ul { padding-left:20px; margin:5px 0; list-style:none; }
    .tree li { padding:6px; cursor:pointer; border-radius:6px; }
    .tree li:hover { background:#30363d; }
    .tree .folder::before { content:"ğŸ“ "; }
    .tree .file::before { content:"ğŸ“„ "; }
    .search { width:100%; padding:12px; background:#0d1117; border:1px solid #30363d; color:white; box-sizing:border-box; }
    #file-content { background:#0d1117; padding:20px; border-radius:8px; min-height:100%; }
    .online-count { position:fixed; bottom:10px; right:10px; background:#238636; color:white; padding:10px 15px; border-radius:50px; font-weight:bold; }
    .refresh { font-size:12px; color:#8b949e; text-align:center; margin-top:10px; }
  </style>
</head>
<body>
  <div class="header">
    <h1>LCP â€“ Chá» táº¡i quÃ¡n net</h1>
    <p>Äang cÃ³ <span id="online">0</span> anh em trong quÃ¡n â€¢ Auto cáº­p nháº­t má»—i 2 phÃºt</p>
  </div>

  <div class="container">
    <div class="sidebar">
      <input type="text" class="search" id="search" placeholder="TÃ¬m file, nick, tin nháº¯n..."/>
      <div class="tree" id="tree">Äang load repo...</div>
    </div>
    </div>
    <div class="content">
      <div id="file-content">
        <h2>ChÃ o má»«ng Ä‘áº¿n vá»›i báº£ng Ä‘iá»‡n tá»­ quÃ¡n net</h2>
        <p>Click vÃ o file bÃªn trÃ¡i Ä‘á»ƒ xem ná»™i dung nhÃ©!</p>
        <p><strong>Máº¹o:</strong> Táº¡o file trong thÆ° má»¥c <code>online/</code> Ä‘á»ƒ hiá»‡n tÃªn lÃªn báº£ng Ä‘áº¿m ngÆ°á»i!</p>
      </div>
    </div>
  </div>

  <div class="online-count">Online: <span id="online2">0</span></div>
  <div class="refresh">Cáº­p nháº­t láº§n cuá»‘i: <span id="time"></span></div>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    const owner = "lapgia57-netizen";
    const repo = "LCP";
    const api = `https://api.github.com/repos/${owner}/${repo}/git/trees/main?recursive=1`;

    async function loadRepo() {
      try {
        const res = await fetch(api);
        const data = await res.json();
        const files = data.tree.filter(f => f.type === "blob");
        document.getElementById("online").textContent = files.filter(f => f.path.startsWith("online/")).length;
        document.getElementById("online2").textContent = document.getElementById("online").textContent;

        renderTree(data.tree);
        updateTime();
      } catch (e) {
        document.getElementById("tree").innerHTML = "Lá»—i káº¿t ná»‘i GitHub API :(";
      }
    }

    function renderTree(items) {
      const ul = document.createElement("ul");
      items.forEach(item => {
        if (item.type === "tree") return; // bá» qua folder thuáº§n (chá»‰ hiá»‡n file)
        else {
          const li = document.createElement("li");
          li.className = "file";
          li.textContent = item.path;
          li.onclick = () => loadFile(item.path);
          ul.appendChild(li);
        }
      });
      const container = document.getElementById("tree");
      container.innerHTML = "";
      container.appendChild(ul);
    }

    async function loadFile(path) {
      const raw = `https://raw.githubusercontent.com/${owner}/${repo}/main/${path}`;
      const res = await fetch(raw);
      const text = await res.text();

      const div = document.getElementById("file-content");
      div.innerHTML = `<h3>${path}</h3>`;
      if (path.endsWith(".md")) {
        div.innerHTML += marked.parse(text);
      } else {
        div.innerHTML += `<pre>${text}</pre>`;
      }
    }

    function updateTime() {
      document.getElementById("time").textContent = new Date().toLocaleString("vi-VN");
    }

    // Tá»± Ä‘á»™ng refresh má»—i 2 phÃºt
    loadRepo();
    setInterval(loadRepo, 120000);

    // TÃ¬m kiáº¿m realtime
    document.getElementById("search").addEventListener("input", (e) => {
      const term = e.target.value.toLowerCase();
      document.querySelectorAll(".file").forEach(li => {
        li.style.display = li.textContent.toLowerCase().includes(term) ? "" : "none";
      });
    });
  </script>
</body>
</html>
